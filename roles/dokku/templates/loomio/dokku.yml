source:
  url: https://github.com/loomio/loomio.git
volumes:
  loomio_data:
    - /uploads
database:
  postgresql: loomio
  memcached: loomio
hostname: loomio.omoikane.ep3.at
certs:
  certificate: selfsigned
env:
  RACK_ENV: production
  RAILS_ENV: production
  DEVISE_SECRET: `openssl rand -base64 48`
  SECRET_COOKIE_TOKEN: `openssl rand -base64 48`
  CANONICAL_HOST: loomio.omoikane.ep3.at
  TLD_LENGTH: 3

files:
  content:
    Procfile: |
        web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb
        worker: bundle exec rake jobs:work
        backup: ./packaging/scripts/backup
        check: ./packaging/scripts/check
        seed: bundle exec rake db:seed
    config/database.yml: |
        production:
          url: <%= ENV['DATABASE_URL'] %>
  append:
    Gemfile: |
        gem "rails_12factor", group: :production
