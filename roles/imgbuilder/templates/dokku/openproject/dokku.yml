source: https://github.com/opf/openproject.git
branch: stable

volume:
  openproject_data:
    - /uploads
database:
  postgresql: openproject
  memcached: openproject
#ssl:
#  certificate: selfsigned
#  key:
env:
  BUNDLE_WITHOUT: "development:test:selenium:mysql:sqlite"
  BUNDLE_WITH: "production:postgres"
  attachments_storage_path: "/uploads"
  rails_cache_store: "memcache"
  cache_namespace: "openproject"

#docker-opts: '-h host.domain.com'

files:
  content:
    Procfile: |
        web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb
        worker: bundle exec rake jobs:work
        backup: ./packaging/scripts/backup
        check: ./packaging/scripts/check
        seed: bundle exec rake db:seed
    config/database.yml: |
        production:
          url: <%= ENV['DATABASE_URL'] %>
    .buildpacks: |
        https://github.com/heroku/heroku-buildpack-nodejs.git#v70
        https://github.com/heroku/heroku-buildpack-ruby.git#v133
  append:
    Gemfile: |
        gem "rails_12factor", group: :production
    .gitignore: |
        /*.bak
  comment:
    .gitignore: ^/?config/database.yml
    Gemfile: ^ *gem "mysql2"

pre_commit:
  - 'bundle install --without="development test selenium mysql sqlite"'

